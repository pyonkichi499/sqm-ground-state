# 要件定義: 確率過程量子化による基底状態の数値計算

## 背景

確率過程量子化（Stochastic Quantization, Parisi-Wu法, 1981）は、虚時間（ユークリッド時間）の経路積分に対して、さらに架空の「確率時間」$t$ を導入し、ランジュバン方程式による確率過程の平衡分布として量子論を再現する手法である。

量子力学（0+1次元の場の理論）の場合、経路 $x(\tau)$ を確率時間 $t$ に沿って次のランジュバン方程式で発展させる:

$$
\frac{\partial x(\tau, t)}{\partial t} = -\frac{\delta S_E[x]}{\delta x(\tau)} + \eta(\tau, t)
$$

ここで $S_E$ はユークリッド作用、$\eta$ は白色ガウスノイズで $\langle \eta(\tau,t)\eta(\tau',t')\rangle = 2\delta(\tau-\tau')\delta(t-t')$ を満たす。

$t \to \infty$ の平衡状態では、確率過程から計算した相関関数がユークリッド経路積分による期待値と一致する。これにより基底状態のエネルギーや波動関数を数値的に抽出できる。

## 目的

1次元量子力学系に対して Parisi-Wu 確率過程量子化を実装し、基底状態のエネルギーと波動関数を数値的に求める。既知の厳密解・近似解と比較して手法の妥当性を検証する。

## 機能要件

### F1: ランジュバン方程式のシミュレーション

- ユークリッド時間 $\tau$ を離散化した格子上で経路 $x_i = x(\tau_i)$ を表現する
- ユークリッド作用 $S_E[x]$ から力 $-\delta S_E / \delta x_i$ を計算する
- ランジュバン方程式を確率時間方向に数値積分する（オイラー・丸山法）
- 熱化（thermalization）後の配位を用いて物理量を測定する

### F2: 対象とするポテンシャル

以下のポテンシャルを段階的にサポートする:

1. **調和振動子**: $V(x) = \frac{1}{2}\omega^2 x^2$
   - 厳密解が既知（$E_0 = \omega/2$）で検証に最適
2. **非調和振動子**: $V(x) = \frac{1}{2}\omega^2 x^2 + \lambda x^4$
   - 摂動論や数値対角化との比較が可能
3. **二重井戸ポテンシャル**: $V(x) = \lambda(x^2 - v^2)^2$
   - トンネル効果・インスタントン物理の検証

### F3: 物理量の測定

- **基底状態エネルギー**: ユークリッド相関関数 $\langle x(\tau) x(0) \rangle$ の大きい $\tau$ での指数減衰から抽出
- **波動関数の確率密度**: $|\psi_0(x)|^2$ を $x$ のヒストグラムとして測定
- **統計誤差**: ビンニング法やジャックナイフ法で自己相関を考慮した誤差を推定

### F4: 既知結果との比較

- 調和振動子の厳密解との一致を定量的に確認する
- 結果をグラフとして可視化する

## 非機能要件

### NF1: 実装言語・技術スタック

- **言語**: Python 3
- **数値計算**: NumPy
- **可視化**: Matplotlib
- **テスト**: pytest

### NF2: プロジェクト構成

```
sqm-ground-state/
├── README.md
├── REQUIREMENTS.md
├── src/
│   ├── __init__.py
│   ├── langevin.py       # ランジュバン方程式ソルバー
│   ├── action.py         # ユークリッド作用とポテンシャル定義
│   ├── observables.py    # 物理量の測定
│   └── analysis.py       # 統計解析（誤差推定など）
├── tests/
│   ├── test_action.py
│   ├── test_langevin.py
│   └── test_observables.py
├── examples/
│   ├── harmonic.py       # 調和振動子の実行例
│   └── anharmonic.py     # 非調和振動子の実行例
└── requirements.txt
```

### NF3: パラメータ

シミュレーションの主要パラメータ:

| パラメータ | 記号 | 説明 |
|-----------|------|------|
| 格子点数 | $N$ | ユークリッド時間の離散化点数 |
| 格子間隔 | $a$ | ユークリッド時間の刻み幅 |
| ランジュバンステップ幅 | $\epsilon$ | 確率時間の刻み幅 |
| 熱化ステップ数 | $N_\text{therm}$ | 平衡到達までのステップ数 |
| 測定ステップ数 | $N_\text{meas}$ | 統計測定に使うステップ数 |
| 測定間隔 | $N_\text{skip}$ | 自己相関を減らすためのスキップ数 |

### NF4: 検証基準

- 調和振動子の基底状態エネルギーが厳密解と **5%以内** で一致すること
- 連続極限（$a \to 0$）での振る舞いが物理的に妥当であること

## 実装の優先順位

1. **Phase 1**: 調和振動子で基本フレームワークを構築・検証
2. **Phase 2**: 非調和振動子に拡張
3. **Phase 3**: 二重井戸ポテンシャルに対応
